[gcode_macro START_PRINT]
description: Start print
gcode:
    {% set bed_temp_param = 'bed' %}
    {% set nozzle_temp_param = 'hotend' %}

    {% set default_bed_temp = 45 %}
    {% set default_nozzle_temp = 200 %}

    {% set start_nozzle_temp_offset = -25 %}

    {% set bed_temp = params[bed_temp_param] | default(default_bed_temp) | float %}
    {% set nozzle_temp = params[nozzle_temp_param] | default(default_nozzle_temp) | float %}

    {% set start_nozzle_temp = nozzle_temp + start_nozzle_temp_offset %}

    G90
    M183
    M104 S{start_nozzle_temp}           ;   Set start nozzle temp
    M140 S{bed_temp}                    ;   Set final bed temperature 
    G4 S10                              ;   Wait a tiny bit so the hotend can heat up a bit
    G28                                 ;   Home
    G1 Z50 F240
    G1 X2 Y10 F3000
    M104 S{nozzle_temp}                 ;   Set final nozzle temp
    M190 S{bed_temp}                    ;   Wait for bed to be ready
    M109 S{nozzle_temp}                 ;   Wait for nozzle to be ready

    _DRAW_PRIME_LINE

