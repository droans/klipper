[gcode_macro SET_FILAMENT_PROPERTIES]
gcode:
    
    {% set max_accel = params.MAX_ACCEL | default(-1) | float %}
    {% set max_speed = params.MAX_SPEED | default(-1) | float %}
    {% set sq_corner_limit = params.SQUARE_CORNER_LIMIT | default(-1) | float %}
    {% set decel_limit = params.MAX_ACCEL_TO_DECEL | default(-1) | float %}
    {% set retract = params.RETRACTION | default(-1) | float %}
    {% set press_adv = params.PRESSURE_ADVANCE | default(-1) | float %}

    {% if max_accel != -1 %}
        SET_VELOCITY_LIMIT ACCEL={max_accel}
        M118 Acceleration Limit set to {max_accel}
    {% endif %}

    {% if max_speed != -1 %}
        SET_VELOCITY_LIMIT VELOCITY={max_speed}
        M118 Speed Limit set to {max_speed}

    {% endif %}

    {% if sq_corner_limit != -1 %}
        SET_VELOCITY_LIMIT SQUARE_CORNER_VELOCITY={sq_corner_limit}
        M118 Square Corner Velocity Limit set to {sq_corner_limit}

    {% endif %}

    {% if decel_limit != -1 %}
        SET_VELOCITY_LIMIT ACCEL_TO_DECEL={decel_limit}
        M118 Accel to Decel Limit set to {decel_limit}
    {% endif %}

    {% if retract != -1 %}
        SET_RETRACTION RETRACTION_LENGTH={retract}
        M118 Retraction set to {retract}
    {% endif %}

    {% if press_adv != -1 %}
        SET_PRESSURE_ADVANCE ADVANCE={press_adv}
        M118 Pressure advance adjusted to {press_adv}
    {% endif %}