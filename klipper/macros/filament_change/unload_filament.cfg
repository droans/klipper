[gcode_macro UNLOAD_CHANGE_FILAMENT]
description: Unload filament to change midprint

gcode:
    {% set unload_mm = params.LOAD_MM | default(printer.save_variables.load_mm) | default(-50) | float %}
    {% set unload_speed = params.LOAD_SPEED | default(printer.save_variables.load_speed) | default(500) | float %}

    {% if unload_mm > 0 %}
        {% set unload_mm = -1 * unload_mm %}
    {% endif %}

    G91

    G1 E{unload_mm} F{unload_speed}
        