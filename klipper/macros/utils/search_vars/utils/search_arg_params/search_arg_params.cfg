[gcode_macro _SEARCH_ARG_PARAMS]
gcode:
    {% set obj = params %}

    {% set vars = params.VARS %}

    {% if vars != -1 %}
        {% if vars is not iterable %}
            {% set vars = vars.split(",") %}
        {% endif %}

        _LOOP_NESTED_DICT DICT=obj DRILL=vars

        {% set obj = printer['gcode_macro _LOOP_NESTED_DICT'].return_value %}

    {% endif %}

    _RETURN_SEARCH_VARS OBJ={obj}