[gcode_macro _BASE_ERROR]
gcode:
    {% set console_err_msg = params.CONSOLE_ERROR_MESSAGE | default(-1) %}
    {% set display_err_msg = params.DISPLAY_ERROR_MESSAGE | default(-1) %}

    {% if console_err_msg != -1 %}
        {% if console_err_msg is not iterable %}
            {% set console_err_msg = (console_err_msg,) %}
        {% endif %}

        {% for item in console_err_msg %}
            M118 {item}
        {% endfor %}

    {% endif %}

    {% if display_err_msg != -1 %}
        {% if display_err_msg is not iterable %}
            {% set display_err_msg = display_err_msg.split(',') %}
        {% endif %}

        {% for item in display_err_msg %}
            M117 {item}
        {% endfor %}
    {% endif %}