[gcode_macro _MISSING_REQUIRED_ARG]
gcode:
    {% set missing_arg = params.ARG %}
    {% set macro_name = params.MACRO_NAME %}
    {% set more_info = params.MORE_INFO | default(-1) %}

    {% set error_on_display = params.SHOW_M117 | default(true) %}
    {% set error_in_console = params.SHOW_M118 | default(true) %}

    {% set error_number = "1001" %}
    
    {% set error_header = "Error " %}

    {% set d_error = [
            error_header,
            "",
            "Missing Required Argument: " + missing_arg
        ]
    %}

    {% set c_error = error_header %}

    {% if error_in_console %}
        {% set c_error = c_error + error_number + " See console." %}

    {% else %}
        {% set c_error = c_error + "(" + macro_name + ") Missing required args" %}
    
    {% endif %}

    {% if more_info != -1 %}
        {% if more_info is not iterable %}
            {% set more_info = [more_info] %}
        {% endif %}

        {% set ns = namespace(e=[]) %}

        {% for item in more_info %}
            {% set ns.e = ns.e + item %}
        {% endfor %}

        {% set d_error = d_error + [""] + ns.e %}

    {% endif %}

    {% if error_on_display and error_in_console %}
        _BASE_ERROR CONSOLE_ERROR_MESSAGE={c_error} DISPLAY_ERROR_MESSAGE={d_error}
    
    {% elif error_on_display %}
        _BASE_ERROR DISPLAY_ERROR_MESSAGE={d_error}

    {% elif error_in_console %}
        _BASE_ERROR CONSOLE_ERROR_MESSAGE={c_error}

    {% endif %}

    


        