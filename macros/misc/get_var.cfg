[gcode_macro GET_PRINTER_OBJECT]
gcode:
    {% set request = params.OBJECT | default(None) %}
    {% set only_keys = params.RETURN_KEYS | default(0) | int %}
    {% set request = request.split(',') %}

    {% set ns = namespace(object=printer) %}

    {% if request is none %}
        M118 

    {% else %}
        {% for item in request %}
            {% if item in ns.object %}
                {% set ns.object = ns.object[item] %}
            {% endif %}
        {% endfor %}

        {% if only_keys == 1 and ns.object is mapping %}
            M118 {ns.object.keys()}
        {% else %}
            M118 {ns.object}
        {% endif %}
    
    {% endif %}