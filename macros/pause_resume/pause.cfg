[gcode_macro PAUSE]
description: Pause the actual running print
rename_existing: PAUSE_BASE
gcode:
  {% set save_gcode_state = params.SAVE_STATE | default(1) %}

  {% set pause_state_name = printer["gcode_macro _CONFIGS"].pause_gcode_state_name %}

  {% set no_save_states = [
      False,
      'false',
      'False',
      'FALSE',
      0,
      0.0,
      '0',
      '0.0'
    ]
  %}

  {% if save_gcode_state not in no_save_states %}
    SET_CONFIG_VAR VAR=pause_gcode_state_saved VAL=True

    SAVE_GCODE_STATE NAME={pause_state_name}
  
  {% else %}
    SET_CONFIG_VAR VAR=pause_gcode_state_saved VAL=False
  {% endif %}

  PAUSE_BASE
