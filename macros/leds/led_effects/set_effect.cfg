[extended_macro SET_EFFECT]
variable_active_leds: {}
gcode:
    {% set effect = params.EFFECT %}
    {% if active_leds == {} %}
        {% set disable_leds = [] %}
        {% set active_leds = add_active_leds(printer, effect) %}
    {% else %}
        {% set disable_leds = disable_effects_gcode(printer, effect, active_leds) %}
        {% set active_leds = add_active_leds(printer, effect, active_leds) %}
        {% for item in disable_leds %}
            {item}
        {% endfor %}
    {% endif %}

    SET_LED_EFFECT EFFECT="{effect}"
